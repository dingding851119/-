<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>æ—…éŠåˆ†å¸³å·¥å…·</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  body {
    font-family: system-ui, -apple-system;
    background: linear-gradient(180deg, #e0f7fa, #ffffff);
    margin: 0;
    padding: 20px;
  }
  h1 { text-align: center; }
  .card {
    background: #fff;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,.08);
  }
  input, button {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    border-radius: 8px;
    border: 1px solid #ccc;
  }
  button {
    background: #26c6da;
    color: #fff;
    border: none;
    font-weight: bold;
  }
  button.secondary {
    background: #ccc;
    color: #333;
  }
  .people label {
    display: block;
  }
</style>
</head>

<body>

<h1>ğŸŒ´ æ—…éŠåˆ†å¸³å°å·¥å…·</h1>
<p style="text-align:center">å…ˆè¨­å®šæ—…ä¼´ â†’ å†è¼¸å…¥æ¯ç­†ä»£å¢Š</p>

<div class="card">
  <h3>ğŸ‘¥ æ—…ä¼´è¨­å®š</h3>
  <input id="peopleInput" placeholder="è¼¸å…¥æ—…ä¼´ï¼Œç”¨é€—è™Ÿåˆ†éš”ï¼ˆä¾‹ï¼šç”²,ä¹™,ä¸™,ä¸ï¼‰">
  <button onclick="setPeople()">å„²å­˜æ—…ä¼´</button>
</div>

<div class="card">
  <h3>ğŸ’¸ æ–°å¢èŠ±è²»</h3>
  <input id="payer" placeholder="ä»£å¢Šè€…åå­—">
  <input id="amount" type="number" placeholder="é‡‘é¡">
  <div id="sharePeople" class="people"></div>
  <button onclick="addExpense()">æ–°å¢é€™ç­†</button>
</div>

<div class="card">
  <h3>ğŸ“Š çµç®—çµæœ</h3>
  <div id="result"></div>
</div>

<button class="secondary" onclick="resetAll()">ğŸ—‘ æ¸…ç©ºå…¨éƒ¨è³‡æ–™</button>

<script>
let people = JSON.parse(localStorage.getItem('people')) || [];
let expenses = JSON.parse(localStorage.getItem('expenses')) || [];

renderPeople();
calculate();

function setPeople() {
  const input = document.getElementById('peopleInput').value;
  people = input.split(',').map(p => p.trim()).filter(Boolean);
  localStorage.setItem('people', JSON.stringify(people));
  renderPeople();
}

function renderPeople() {
  const div = document.getElementById('sharePeople');
  div.innerHTML = '<p>é€™ç­†è¦åˆ†æ”¤çš„äººï¼š</p>';
  people.forEach(p => {
    div.innerHTML += `<label><input type="checkbox" value="${p}" checked> ${p}</label>`;
  });
}

function addExpense() {
  const payer = document.getElementById('payer').value.trim();
  const amount = Number(document.getElementById('amount').value);
  const shares = [...document.querySelectorAll('#sharePeople input:checked')].map(c => c.value);

  if (!payer || amount <= 0 || shares.length === 0) {
    alert('è³‡æ–™ä¸å®Œæ•´');
    return;
  }

  expenses.push({ payer, amount, shares });
  localStorage.setItem('expenses', JSON.stringify(expenses));
  calculate();
}

function calculate() {
  const balance = {};
  people.forEach(p => balance[p] = 0);

  expenses.forEach(e => {
    const per = e.amount / e.shares.length;
    e.shares.forEach(p => balance[p] -= per);
    balance[e.payer] += e.amount;
  });

  let output = '';
  for (const p in balance) {
    output += `${p}ï¼š${balance[p].toFixed(0)} å…ƒ<br>`;
  }
  document.getElementById('result').innerHTML = output;
}

function resetAll() {
  if (!confirm('ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰è³‡æ–™ï¼Ÿ')) return;
  localStorage.clear();
  people = [];
  expenses = [];
  document.getElementById('result').innerHTML = '';
  document.getElementById('sharePeople').innerHTML = '';
}
</script>

</body>
</html>
